---
import { getCollection } from 'astro:content';
import { PrevNextNav } from '../components/common/PrevNextNav';

const { frontmatter, slug } = Astro.props;
const { title, date, tags, summary } = frontmatter;

const allPosts = (await getCollection('articles')).map((p) => ({
  slug: p.slug,
  title: p.data.title,
  date: new Date(p.data.date),
})).sort((a, b) => b.date.getTime() - a.date.getTime());
---

<article class="prose mx-auto px-4 py-8 max-w-3xl">
  <header class="mb-6">
    <h2 class="text-3xl font-bold mb-2">{title}</h2>
    <p class="text-sm text-gray-500">{new Date(date).toLocaleDateString()}</p>
    {tags && (
      <ul class="flex flex-wrap gap-2 mt-2">
        {tags.map(tag => (
          <li class="text-xs bg-gray-200 rounded px-2 py-1">{tag}</li>
        ))}
      </ul>
    )}
  </header>

  <section class="markdown-body">
	<slot />
    <PrevNextNav posts={allPosts} currentSlug={slug} />
  </section>
</article>

